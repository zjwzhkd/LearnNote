# C++学习笔记4 - 函数的升级(下)

[TOC]

## 重载(Overload)
* 同一个标识符在不同的上下文有不同的意义

## 函数重载(Function Overload)
* 用同一个函数名定义不同的函数
* 当函数名和不同的参数搭配时函数的含义不同
* 函数重载至少满足下面的一个条件:
    * 参数个数不同
    * 参数类型不同
    * 参数顺序不同
* 函数重载与默认参数
    * 默认参数不影响函数重载的条件
    * 默认参数可能会造成二义性, 导致编译失败

    ```c++
    // 符合函数重载条件, 编译通过
    int func(int a) {};
    int func(int a, int b = 0) {};

    // 二义性导致编译失败
    func(1);
    ```

* 函数重载调用准则
    * 将所有的同名函数作为候选者, 称为**候选函数**
    * 尝试寻找可行的候选函数, 称为**可行函数**
        * 精确匹配实参
        * 通过默认参数能够匹配实参
        * 通过默认类型转换匹配实参
    * 寻找最佳匹配的可行函数(有且只有1个)
        * 该函数每个实参的匹配都不劣于其它的可行函数
        * 至少有一个实参的匹配优于其它的可行函数
    * 匹配失败
        * 最终寻找到的可行候选函数不唯一, 且不存在最佳匹配的可行函数, 则出现二义性, 编译失败
        * 无法寻找到可行函数, 则函数未定义, 编译失败

* 函数重载的注意事项
    * 重载函数在本质上是相互独立的不同函数
    * 重载函数的函数类型是不同的
    * 函数返回值不能作为函数重载的依据
    * 函数重载是由**函数名**和**参数列表**决定的, 与返回值无关

* 函数重载和函数指针
    * 当使用重载函数名对函数指针进行赋值时
        * 依据重载规则挑选与函数指针参数列表一致的候选者
        * 严格匹配候选者的函数类型与函数指针的函数类型

## C++和C的相互调用
* 在项目中融合C++和C代码是实际工程中不可避免的
* 虽然C++编译器能够兼容C语言的编译方式, 但C++编译器会优先使用C++的方式进行编译
* 利用extern关键字强制让C++编译器对代码进行C方式编译

    ```c++
    extern "C" {
        // 以C方式编译
    }
    ```

* 统一的解决方案
    * 可以在C编译器中编译, 也可以在C++编译器中以C语言方式编译

    ```c++
    #ifdef __cplusplus
    extern "C" {
    #endif

    // 需要以C方式编译的函数的声明和定义

    #ifdef __cplusplus
    }
    #endif
    ```

* C++编译器不能以C的方式编译多个重载函数

## 小结
* 函数重载是C++对C语言的一个重要升级
* 函数重载通过函数参数列表区分不同的同名函数
* 函数的返回值类型不是函数重载的依据
* extern关键字能够实现C和C++的相互调用
